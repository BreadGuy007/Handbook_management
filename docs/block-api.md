# ブロック API

ブロックは Gutenberg の基本要素で、プラグインとテーマが独自の機能を登録し、エディタの機能を拡張する主な手段となります。このドキュメントでは、ブロック登録の主な特性について説明します。

## Block タイプの登録

* **タイプ:** `Function`

すべてのブロックは、新しいブロックタイプ定義を登録することから始まります。関数 `registerBlockType` では、ブロック名 (`name`) とブロック構成オブジェクトという2つの引数が使えます。

### ブロック名

* ** タイプ:** `String`

ブロックの名前は、ブロックを識別する固有の文字列です。名前は `namespace/block-name` (名前空間/ブロック名) として構造化する必要があります。ここでの名前空間はプラグイン名またはテーマ名前になります。

```js
// ブロックに一意の名前を登録する
registerBlockType( 'my-plugin/book', {} );
```

*注:* ブロック名には小文字の英数字とハイフンのみを含めることができ、最初は文字にする必要があります。

*注:* この名前は `<!-- wp:my-plugin/book -->` のようにコメント区切り文字内で使用されます。コアによって提供されるブロックがシリアライズされる際には、名前空間は含まれません。

### ブロック構成

* **タイプ:** `{ key: value }`

ブロックを正しく登録するには、いくつかのプロパティを指定する必要があります。これらは、次のような構成オブジェクトによって定義されます。

#### タイトル

* **タイプ:** `String`

これはブロックの表示タイトルであり、翻訳機能で翻訳できます。ブロックインサーターにこの名前が表示されます。

```js
// データオブジェクト
title: 'Book'
```

#### 説明 (オプション)

* **タイプ:** `String`

これはブロックの簡単な説明であり、翻訳機能で翻訳できます。ブロックインスペクターに表示されます。

```js
description: 'Block showing a Book card.'
```

#### カテゴリー

* **タイプ:** `String [ common | formatting | layout | widgets | embed ]`

ブロックは、ユーザーが拾い読みして発見できるよう、カテゴリーにグループ化されています。コアが提供するカテゴリーは `common`、`formatting`、`layout`、`widgets`、`embed` です。

```js
// 'layout' カテゴリーを割り当て
category: 'widgets',
```

#### アイコン (オプション)

ブロックを簡単に識別できるように、アイコンプロパティを指定することが推奨されています。[WordPress の Dashicon](https://developer.wordpress.org/resource/dashicons/)、またはカスタム `svg` 要素のいずれかになります。

```js
// ブロックに dashicon を指定
icon: 'book-alt',
```

#### キーワード (オプション)

ユーザーが検索中にブロックを発見するのを助けるエイリアスがブロックに存在することがあります。例えば、`image` ブロックは `photo` でも発見できるかもしれません。これを実現するには、(翻訳可能な) 用語の配列を提供します。ブロックごとに用語を3つまで追加することのみが許可されています。

```js
// キーワードエイリアスでブロックを簡単に発見できるようにする
keywords: [ __( 'read' ) ],
```

#### 属性 (オプション)

* **タイプ:** `{ attr: {} }`

属性はブロックの構造化データのニーズを提供します。シリアライズされた際には異なる形式で存在できますが、共通インタフェースの下では一緒に宣言されます。

```js
// ブロック属性を指定
attributes: {
	cover: {
		type: 'string',
		source: 'attribute',
		selector: 'img',
		attribute: 'src',
	},
	author: {
		type: 'string',
		source: 'children',
		selector: '.book-author',
	},
	pages: {
		type: 'number',
	},
},
```

* **参照: [属性](https://wordpress.org/gutenberg/handbook/block-api/attributes/)**

#### Transforms (オプション)

作業中…

#### useOnce (オプション)

* **タイプ:** `Bool`
* **デフォルト:** `false`

1回限りのブロックは各投稿に1回のみ挿入できます。たとえば、編集中の投稿にビルトイン「More (続きを読む)」ブロックがすでに存在する場合、再度挿入することはできません。1回限りのブロックのアイコンは、複数のインスタンスを防ぐために自動的に淡色表示 (クリック不可) されます。

```js
// ブロックを投稿ごとに1回だけ使う
useOnce: true,
```

#### supports (オプション)

* **タイプ:** `Object`

オプションのブロック拡張サポート機能。次のオプションがサポートされており、`true` または `false` のブール値として指定する必要があります。

- `anchor` (デフォルト `false`): アンカーを使用すると、ページ上の特定のブロックに直接リンクできます。このプロパティは、ブロックの ID と直リンクをコピーするボタンを定義するフィールドを追加します。

```js
// アンカーリンクのサポートを追加。
anchor: true,
```

- `customClassName` (デフォルト `true`): このプロパティは、ブロックのラッパーにカスタム className を定義するフィールドを追加します。

```js
// カスタム className のサポートを削除。
customClassName: false,
```

- `className` (デフォルト `true`): デフォルトでは、Gutenberg は保存したマークアップのルート要素に `.wp-block-your-block-name` という形式のクラスを追加します。これは、ブロックにスタイルを付けるためにテーマとプラグインが頼りにできる一貫したメカニズムを持たせるのに役立ちます。何らかの理由でマークアップ内のクラスが望ましくない場合、この機能は無効にできます。

```js
// 生成 className のサポートを削除。
className: false,
```

- `html` (デフォルト `true`): デフォルトでは、Gutenberg はブロックのマークアップの個別編集を許可しています。この動作を無効にするには、`html` を `false` に設定します。

```js
// HTML モードのサポートを削除。
html: false,
```

## 編集と保存

`edit` と `save` 機能は、ユーザーがやりとりするエディターのインタフェースと、投稿の保存時にシリアライズされるマークアップを定義します。ブロックがどのように動作するかの核心部分であるため、[別途ドキュメンテーションを用意](https://wordpress.org/gutenberg/handbook/block-edit-save/)しています。
